<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lista de Projetos</title>
    <style>
        .running {
            color: green;
        }
        .pod-item {
            font-size: 0.9em; /* Smaller font size */
        }
    </style>
</head>
<body>
    <h1>Lista de Projetos</h1>
    <ul id="project-list"></ul>

    <script>
        async function fetchProjects() {
            try {
                const response = await fetch('/api/projects');
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }

                const data = await response.json();
                const projectList = document.getElementById('project-list');
                for (const project of data.items) {
                    const listItem = document.createElement('li');
                    listItem.textContent = project.metadata.name;
                    projectList.appendChild(listItem);

                    const podList = document.createElement('ul');
                    listItem.appendChild(podList);

                    const podsResponse = await fetch(`/api/projects/${project.metadata.name}/pods`);
                    if (!podsResponse.ok) {
                        throw new Error(`HTTP error! status: ${podsResponse.status}`);
                    }

                    const podsData = await podsResponse.json();
                    for (const pod of podsData) {
                        const podItem = document.createElement('li');
                        podItem.textContent = pod.name;
                        podItem.classList.add('pod-item'); // Add class for smaller font size
                        if (pod.phase === 'Running') {
                            podItem.classList.add('running');
                        } else {
                            podItem.textContent += ` (${pod.phase})`;
                        }
                        podList.appendChild(podItem);
                    }
                }
            } catch (error) {
                console.error('Fetch error:', error);
            }
        }

        fetchProjects();
    </script>
</body>
</html>